{
  "hash": "f6c184bf4a5aea89c0e2bc70bce71b34",
  "result": {
    "markdown": "---\ntitle: \"Data Acquisition\"\nauthor: \"Jamila Rzayeva\"\n---\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-2_969d5c8bc801c8fc5e36ef32767cd594'}\n\n```{.r .cell-code}\nlibrary(httr)\nlibrary(jsonlite)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'jsonlite'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following object is masked from 'package:purrr':\n#> \n#>     flatten\n```\n:::\n\n```{.r .cell-code}\nurl <- \"https://jsonplaceholder.typicode.com/posts\"\n\nresponse <- GET(url)\n\ncontent <- content(response, \"text\")\n\nposts <- fromJSON(content)\n\nhead(posts, 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"userId\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"id\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"title\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"body\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"1\",\"2\":\"1\",\"3\":\"sunt aut facere repellat provident occaecati excepturi optio reprehenderit\",\"4\":\"quia et suscipit\\\\nsuscipit recusandae consequuntur expedita et cum\\\\nreprehenderit molestiae ut ut quas totam\\\\nnostrum rerum est autem sunt rem eveniet architecto\",\"_rn_\":\"1\"},{\"1\":\"1\",\"2\":\"2\",\"3\":\"qui est esse\",\"4\":\"est rerum tempore vitae\\\\nsequi sint nihil reprehenderit dolor beatae ea dolores neque\\\\nfugiat blanditiis voluptate porro vel nihil molestiae ut reiciendis\\\\nqui aperiam non debitis possimus qui neque nisi nulla\",\"_rn_\":\"2\"},{\"1\":\"1\",\"2\":\"3\",\"3\":\"ea molestias quasi exercitationem repellat qui ipsa sit aut\",\"4\":\"et iusto sed quo iure\\\\nvoluptatem occaecati omnis eligendi aut ad\\\\nvoluptatem doloribus vel accusantium quis pariatur\\\\nmolestiae porro eius odio et labore et velit aut\",\"_rn_\":\"3\"},{\"1\":\"1\",\"2\":\"4\",\"3\":\"eum et est occaecati\",\"4\":\"ullam et saepe reiciendis voluptatem adipisci\\\\nsit amet autem assumenda provident rerum culpa\\\\nquis hic commodi nesciunt rem tenetur doloremque ipsam iure\\\\nquis sunt voluptatem rerum illo velit\",\"_rn_\":\"4\"},{\"1\":\"1\",\"2\":\"5\",\"3\":\"nesciunt quas odio\",\"4\":\"repudiandae veniam quaerat sunt sed\\\\nalias aut fugiat sit autem sed est\\\\nvoluptatem omnis possimus esse voluptatibus quis\\\\nest aut tenetur dolor neque\",\"_rn_\":\"5\"},{\"1\":\"1\",\"2\":\"6\",\"3\":\"dolorem eum magni eos aperiam quia\",\"4\":\"ut aspernatur corporis harum nihil quis provident sequi\\\\nmollitia nobis aliquid molestiae\\\\nperspiciatis et ea nemo ab reprehenderit accusantium quas\\\\nvoluptate dolores velit et doloremque molestiae\",\"_rn_\":\"6\"},{\"1\":\"1\",\"2\":\"7\",\"3\":\"magnam facilis autem\",\"4\":\"dolore placeat quibusdam ea quo vitae\\\\nmagni quis enim qui quis quo nemo aut saepe\\\\nquidem repellat excepturi ut quia\\\\nsunt ut sequi eos ea sed quas\",\"_rn_\":\"7\"},{\"1\":\"1\",\"2\":\"8\",\"3\":\"dolorem dolore est ipsam\",\"4\":\"dignissimos aperiam dolorem qui eum\\\\nfacilis quibusdam animi sint suscipit qui sint possimus cum\\\\nquaerat magni maiores excepturi\\\\nipsam ut commodi dolor voluptatum modi aut vitae\",\"_rn_\":\"8\"},{\"1\":\"1\",\"2\":\"9\",\"3\":\"nesciunt iure omnis dolorem tempora et accusantium\",\"4\":\"consectetur animi nesciunt iure dolore\\\\nenim quia ad\\\\nveniam autem ut quam aut nobis\\\\net est aut quod aut provident voluptas autem voluptas\",\"_rn_\":\"9\"},{\"1\":\"1\",\"2\":\"10\",\"3\":\"optio molestias id quia eum\",\"4\":\"quo et expedita modi cum officia vel magni\\\\ndoloribus qui repudiandae\\\\nvero nisi sit\\\\nquos veniam quod sed accusamus veritatis error\",\"_rn_\":\"10\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(glue)\nlibrary(rvest)\n\nurl_home <- \"https://www.rosebikes.de/fahrräder\"\nhtml_home <- read_html(url_home)\nbike_cats <- html_home %>%\n  html_nodes(css = \".catalog-navigation__link\")\nlinks <- sapply(bike_cats, function(x) {x %>% html_attr(\"href\")})\nlinks <- links[1:9] %>%\n  enframe(name = \"position\", value = \"subdirectory\") %>%\n  mutate(\n    url = glue(\"https://www.rosebikes.de{subdirectory}\"))  %>%\n  distinct(url)\n\nget_data <- function(url) {\n  html_bike_cat <- read_html(url)\n  \n  listings <- html_nodes(html_bike_cat, css = '.catalog-category-bikes__price-title') %>% \n    html_text(trim=TRUE) %>%              \n    str_replace_all(\" \",\"\") %>%\n    str_replace_all(\"ab\", \"\") %>%\n    str_replace_all(\"€\", \"\") %>%\n    str_replace_all(\"\\n\", \"\") %>%\n    str_replace_all(\"\\\\.\", \"\") %>%\n    str_replace_all(\",\", \"\\\\.\") %>%\n    iconv('utf-8', 'ascii', sub='') %>%\n    as.numeric()\n  \n  names <- html_nodes(html_bike_cat, xpath = '//basic-headline/h4') %>% \n    html_text() %>%\n    str_replace_all(\"\\n\", \"\") %>%\n    str_to_title()\n  \n  categories <- rep(url %>% str_replace_all(\"https://www.rosebikes.de/fahrräder/\", \"\"), \n              each=length(names)) %>%\n    str_to_title()\n  \n  return(list(\"listings\" = listings, \"names\" = names, \"categories\" = categories))\n}\n\ndata <- get_data(links$url[1])\nbike_data <- tibble(bike.type = data$categories,\n                    bike.name = data$names,\n                    bike.price = as.numeric(data$listings))\nfor (i in 2:9) {\n  data <- get_data(links$url[i])\n  \n  bike_data <- bike_data %>% add_row(bike.type = data$categories,\n                                     bike.name = data$names,\n                                     bike.price = as.numeric(data$listings))\n}\n\nhead(bike_data, 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"bike.type\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"bike.name\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"bike.price\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Mtb\",\"2\":\"Count Solo\",\"3\":\"749\"},{\"1\":\"Mtb\",\"2\":\"Psycho Path\",\"3\":\"1499\"},{\"1\":\"Mtb\",\"2\":\"Thrill Hill\",\"3\":\"2999\"},{\"1\":\"Mtb\",\"2\":\"Root Miller Plus\",\"3\":\"4999\"},{\"1\":\"Mtb\",\"2\":\"Ground Control\",\"3\":\"1999\"},{\"1\":\"Mtb\",\"2\":\"Root Miller\",\"3\":\"2299\"},{\"1\":\"Mtb\",\"2\":\"Bonero\",\"3\":\"1499\"},{\"1\":\"Mtb\",\"2\":\"Soul Fire\",\"3\":\"1999\"},{\"1\":\"Mtb\",\"2\":\"The Bruce\",\"3\":\"899\"},{\"1\":\"Rennrad\",\"2\":\"Xlite\",\"3\":\"2999\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}